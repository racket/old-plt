% Expression rules

\rulesection{tuple\_or\_test}
\label{tuplezzzorzzztestb}
\begin{tabular}{lcl}
{\bf \verb+<+tuple\_or\_test\verb+>+} & ::=  & {\bf \verb+<+tuple~\ref{tupleb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
\end{tabular}

\rulesection{tuple}
\label{tupleb}
\begin{tabular}{lcl}
{\bf \verb+<+tuple\verb+>+} & ::=  & {\bf \verb+<+testlist~\ref{testlistb}\verb+>+}  \\
\end{tabular} \\

A tuple has the same syntactic rules as a testlist (\ref{testlistb}), but the name ``tuple'' is more descriptive sometimes.

\rulesection{test}
\label{testb}

See the Python reference~\cite{pythonlang}, section 5.10.

\begin{tabular}{lcl}
{\bf \verb+<+test\verb+>+} & ::=  & {\bf \verb+<+or\_test~\ref{orzzztestb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+lambdef~\ref{lambdefb}\verb+>+}  \\
\end{tabular}

\rulesection{test\_list}
\label{testzzzlistb}
\begin{tabular}{lcl}
{\bf \verb+<+test\_list\verb+>+} & ::=  & $\varepsilon$ \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| {\bf \verb+<+test\_list~\ref{testzzzlistb}\verb+>+}  \\
\end{tabular} \\

This non-terminal is only used by \verb|print| statements (\ref{printzzzstmtb}).

\rulesection{testlist}
\label{testlistb}
\begin{tabular}{lcl}
{\bf \verb+<+testlist\verb+>+} & ::=  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| {\bf \verb+<+testlist~\ref{testlistb}\verb+>+}  \\
\end{tabular} \\

See note for {\bf test\_{}list~\ref{testzzzlistb}}.  A {\bf testlist} is never empty.
This non-terminal is used by:

\begin{itemize}
\item \textbf{tuple} (\ref{tupleb});
\item \textbf{listmaker} (\ref{listmakerb});
\item \textbf{testlist\_safe} (\ref{testlistzzzsafeb});
\item and class definitions: \textbf{classdef} (\ref{classdefb}).
\end{itemize} 

\rulesection{lambdef}
\label{lambdefb}
\begin{tabular}{lcl}
{\bf \verb+<+lambdef\verb+>+} & ::=  & lambda {\bf \verb+<+varargslist~\ref{varargslistb}\verb+>+}  \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & lambda \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
\end{tabular}

\rulesection{or\_test}
\label{orzzztestb}
\begin{tabular}{lcl}
{\bf \verb+<+or\_test\verb+>+} & ::=  & {\bf \verb+<+and\_test~\ref{andzzztestb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+or\_test~\ref{orzzztestb}\verb+>+}  or {\bf \verb+<+and\_test~\ref{andzzztestb}\verb+>+}  \\
\end{tabular}

\rulesection{and\_test}
\label{andzzztestb}
\begin{tabular}{lcl}
{\bf \verb+<+and\_test\verb+>+} & ::=  & {\bf \verb+<+not\_test~\ref{notzzztestb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+and\_test~\ref{andzzztestb}\verb+>+}  and {\bf \verb+<+not\_test~\ref{notzzztestb}\verb+>+}  \\
\end{tabular}

\rulesection{not\_test}
\label{notzzztestb}
\begin{tabular}{lcl}
{\bf \verb+<+not\_test\verb+>+} & ::=  & not {\bf \verb+<+not\_test~\ref{notzzztestb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+comparison~\ref{comparisonb}\verb+>+}  \\
\end{tabular}

\rulesection{comparison}
\label{comparisonb}
\begin{tabular}{lcl}
{\bf \verb+<+comparison\verb+>+} & ::=  & {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+comparison~\ref{comparisonb}\verb+>+}  {\bf \verb+<+comp\_op~\ref{compzzzopb}\verb+>+}  {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \\
\end{tabular}

\rulesection{comp\_op}
\label{compzzzopb}
\begin{tabular}{lcl}
{\bf \verb+<+comp\_op\verb+>+} & ::=  & \verb|<| \\
 & \verb+|+  & \verb|>| \\
 & \verb+|+  & \verb|==| \\
 & \verb+|+  & \verb|>=| \\
 & \verb+|+  & \verb|<=| \\
 & \verb+|+  & \verb|<>| \\
 & \verb+|+  & \verb|!=| \\
 & \verb+|+  & in \\
 & \verb+|+  & not in \\
 & \verb+|+  & is \\
 & \verb+|+  & is not \\
\end{tabular}

\rulesection{expr}
\label{exprb}
\begin{tabular}{lcl}
{\bf \verb+<+expr\verb+>+} & ::=  & {\bf \verb+<+xor\_expr~\ref{xorzzzexprb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \verb+|+ {\bf \verb+<+xor\_expr~\ref{xorzzzexprb}\verb+>+}  \\
\end{tabular}

\rulesection{xor\_expr}
\label{xorzzzexprb}
\begin{tabular}{lcl}
{\bf \verb+<+xor\_expr\verb+>+} & ::=  & {\bf \verb+<+and\_expr~\ref{andzzzexprb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+xor\_expr~\ref{xorzzzexprb}\verb+>+}  \verb|^| {\bf \verb+<+and\_expr~\ref{andzzzexprb}\verb+>+}  \\
\end{tabular}

\rulesection{and\_expr}
\label{andzzzexprb}
\begin{tabular}{lcl}
{\bf \verb+<+and\_expr\verb+>+} & ::=  & {\bf \verb+<+shift\_expr~\ref{shiftzzzexprb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+and\_expr~\ref{andzzzexprb}\verb+>+}  \verb|&| {\bf \verb+<+shift\_expr~\ref{shiftzzzexprb}\verb+>+}  \\
\end{tabular}

\rulesection{shift\_expr}
\label{shiftzzzexprb}
\begin{tabular}{lcl}
{\bf \verb+<+shift\_expr\verb+>+} & ::=  & {\bf \verb+<+arith\_expr~\ref{arithzzzexprb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+shift\_expr~\ref{shiftzzzexprb}\verb+>+}  \verb|<<| {\bf \verb+<+arith\_expr~\ref{arithzzzexprb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+shift\_expr~\ref{shiftzzzexprb}\verb+>+}  \verb|>>| {\bf \verb+<+arith\_expr~\ref{arithzzzexprb}\verb+>+}  \\
\end{tabular}

\rulesection{arith\_expr}
\label{arithzzzexprb}
\begin{tabular}{lcl}
{\bf \verb+<+arith\_expr\verb+>+} & ::=  & {\bf \verb+<+term~\ref{termb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+arith\_expr~\ref{arithzzzexprb}\verb+>+}  \verb|+| {\bf \verb+<+term~\ref{termb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+arith\_expr~\ref{arithzzzexprb}\verb+>+}  \verb|-| {\bf \verb+<+term~\ref{termb}\verb+>+}  \\
\end{tabular}

\rulesection{term}
\label{termb}
\begin{tabular}{lcl}
{\bf \verb+<+term\verb+>+} & ::=  & {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+term~\ref{termb}\verb+>+}  \verb|*| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+term~\ref{termb}\verb+>+}  \verb|/| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+term~\ref{termb}\verb+>+}  \verb|%| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+term~\ref{termb}\verb+>+}  \verb|//| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
\end{tabular}

\rulesection{factor}
\label{factorb}
\begin{tabular}{lcl}
{\bf \verb+<+factor\verb+>+} & ::=  & \verb|+| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
 & \verb+|+  & \verb|-| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
 & \verb+|+  & \verb|~| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+power~\ref{powerb}\verb+>+}  \\
\end{tabular}

\rulesection{power}
\label{powerb}
\begin{tabular}{lcl}
{\bf \verb+<+power\verb+>+} & ::=  & {\bf \verb+<+atom~\ref{atomb}\verb+>+}  {\bf \verb+<+trailer\_list~\ref{trailerzzzlistb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+atom~\ref{atomb}\verb+>+}  {\bf \verb+<+trailer\_list~\ref{trailerzzzlistb}\verb+>+}  \verb|**| {\bf \verb+<+factor~\ref{factorb}\verb+>+}  \\
\end{tabular} \\

A trailer list is an index operation (e.g., the \verb|[7]| in \verb|x[7]|), a function argument list, or a class attribute reference.

\rulesection{trailer\_list}
\label{trailerzzzlistb}
\begin{tabular}{lcl}
{\bf \verb+<+trailer\_list\verb+>+} & ::=  & $\varepsilon$ \\
 & \verb+|+  & {\bf \verb+<+trailer~\ref{trailerb}\verb+>+}  {\bf \verb+<+trailer\_list~\ref{trailerzzzlistb}\verb+>+}  \\
\end{tabular}

\rulesection{trailer}
\label{trailerb}
\begin{tabular}{lcl}
{\bf \verb+<+trailer\verb+>+} & ::=  & ( ) \\
 & \verb+|+  & ( {\bf \verb+<+arglist~\ref{arglistb}\verb+>+}  ) \\
 & \verb+|+  & [ {\bf \verb+<+subscriptlist~\ref{subscriptlistb}\verb+>+}  ] \\
 & \verb+|+  & [ {\bf \verb+<+subscript~\ref{subscriptb}\verb+>+}  ] \\
 & \verb+|+  & \verb|.| {\bf \verb+<+ident~\ref{identb}\verb+>+}  \\
\end{tabular}

%arglist has been moved
\rulesection{arglist}
\label{arglistb}
\begin{tabular}{lcl}
{\bf \verb+<+arglist\verb+>+} & ::=  & \verb|**| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & \verb|*| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & \verb|*| {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| \verb|**| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+argument~\ref{argumentb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+argument~\ref{argumentb}\verb+>+}  \verb|,| \\
 & \verb+|+  & {\bf \verb+<+argument~\ref{argumentb}\verb+>+}  \verb|,| {\bf \verb+<+arglist~\ref{arglistb}\verb+>+}  \\
\end{tabular}

\rulesection{argument}
\label{argumentb}
\begin{tabular}{lcl}
{\bf \verb+<+argument\verb+>+} & ::=  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+ident~\ref{identb}\verb+>+}  \verb|=| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
\end{tabular}

\rulesection{atom}
\label{atomb}
\begin{tabular}{lcl}
{\bf \verb+<+atom\verb+>+} & ::=  & ( {\bf \verb+<+tuple\_or\_test~\ref{tuplezzzorzzztestb}\verb+>+}  ) \\
 & \verb+|+  & [ {\bf \verb+<+listmaker~\ref{listmakerb}\verb+>+}  ] \\
 & \verb+|+  & \{ {\bf \verb+<+dictmaker~\ref{dictmakerb}\verb+>+}  \} \\
 & \verb+|+  & ( ) \\
 & \verb+|+  & [ ] \\
 & \verb+|+  & \{ \} \\
 & \verb+|+  & ` {\bf \verb+<+tuple\_or\_test~\ref{tuplezzzorzzztestb}\verb+>+}  ` \\
 & \verb+|+  & {\bf \verb+<+ident~\ref{identb}\verb+>+}  \\
 & \verb+|+  & NUMBER \\
 & \verb+|+  & {\bf \verb+<+string\_list\_plus~\ref{stringzzzlistzzzplusb}\verb+>+}  \\
\end{tabular} \\

\begin{itemize}
\item ( ) is the empty tuple
\item \verb|[ ]| is the empty list
\item \{ \} is the empty dictionary
\item \verb|`|\ldots\verb|`| is a shortcut for \verb|repr(|\ldots\verb|)|
\end{itemize}

\rulesection{string\_list\_plus}
\label{stringzzzlistzzzplusb}
\begin{tabular}{lcl}
{\bf \verb+<+string\_list\_plus\verb+>+} & ::=  & STRING \\
 & \verb+|+  & STRING {\bf \verb+<+string\_list\_plus~\ref{stringzzzlistzzzplusb}\verb+>+}  \\
\end{tabular}

\rulesection{listmaker}
\label{listmakerb}
\begin{tabular}{lcl}
{\bf \verb+<+listmaker\verb+>+} & ::=  & {\bf \verb+<+test~\ref{testb}\verb+>+}  {\bf \verb+<+list\_for~\ref{listzzzforb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+testlist~\ref{testlistb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
\end{tabular}

\rulesection{list\_iter}
\label{listzzziterb}
\begin{tabular}{lcl}
{\bf \verb+<+list\_iter\verb+>+} & ::=  & {\bf \verb+<+list\_for~\ref{listzzzforb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+list\_if~\ref{listzzzifb}\verb+>+}  \\
\end{tabular}

\rulesection{list\_for}
\label{listzzzforb}

\settowidth{\tw}{list\_for  ::=  }
\addtolength{\tw}{2\arraycolsep}

\setlength{\len}{\textwidth}
\addtolength{\len}{-1\tw}
\begin{tabular}{lcp{\len}}
{\bf \verb+<+list\_for\verb+>+} & ::=  & for {\bf \verb+<+target\_tuple\_or\_expr~\ref{targetzzztuplezzzorzzzexprb}\verb+>+}  in {\bf \verb+<+testlist\_safe~\ref{testlistzzzsafeb}\verb+>+}  \\
 & \verb+|+  & for {\bf \verb+<+target\_tuple\_or\_expr~\ref{targetzzztuplezzzorzzzexprb}\verb+>+}  in {\bf \verb+<+testlist\_safe~\ref{testlistzzzsafeb}\verb+>+}  {\bf \verb+<+list\_iter~\ref{listzzziterb}\verb+>+}  \\
\end{tabular} \\

See the Python reference~\cite{pythonlang}, section 5.2.4.

\rulesection{list\_if}
\label{listzzzifb}
\begin{tabular}{lcl}
{\bf \verb+<+list\_if\verb+>+} & ::=  & if {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & if {\bf \verb+<+test~\ref{testb}\verb+>+}  {\bf \verb+<+list\_iter~\ref{listzzziterb}\verb+>+}  \\
\end{tabular}

\rulesection{subscriptlist}
\label{subscriptlistb}
\begin{tabular}{lcl}
{\bf \verb+<+subscriptlist\verb+>+} & ::=  & {\bf \verb+<+subscript~\ref{subscriptb}\verb+>+}  \verb|,| \\
 & \verb+|+  & {\bf \verb+<+subscript~\ref{subscriptb}\verb+>+}  \verb|,| {\bf \verb+<+subscript~\ref{subscriptb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+subscript~\ref{subscriptb}\verb+>+}  \verb|,| {\bf \verb+<+subscriptlist~\ref{subscriptlistb}\verb+>+}  \\
\end{tabular}

%the last production had to be changed from \verb|.| \verb|.| \verb|.| to \verb|...|
\rulesection{subscript}
\label{subscriptb}
\begin{tabular}{lcl}
{\bf \verb+<+subscript\verb+>+} & ::=  & \verb|:| \\
 & \verb+|+  & \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|:| \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & \verb|:| {\bf \verb+<+sliceop~\ref{sliceopb}\verb+>+}  \\
 & \verb+|+  & \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  {\bf \verb+<+sliceop~\ref{sliceopb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|:| {\bf \verb+<+sliceop~\ref{sliceopb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  {\bf \verb+<+sliceop~\ref{sliceopb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & \verb|...| \\
\end{tabular}

\rulesection{sliceop}
\label{sliceopb}
\begin{tabular}{lcl}
{\bf \verb+<+sliceop\verb+>+} & ::=  & \verb|:| \\
 & \verb+|+  & \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
\end{tabular} \\

This non-terminal occurs only inside of a {\bf subscript} (\ref{subscriptb}).

\rulesection{exprlist}
\label{exprlistb}
\begin{tabular}{lcl}
{\bf \verb+<+exprlist\verb+>+} & ::=  & {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \verb|,| \\
 & \verb+|+  & {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \verb|,| {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \verb|,| {\bf \verb+<+exprlist~\ref{exprlistb}\verb+>+}  \\
\end{tabular}

\rulesection{target\_tuple\_or\_expr}
\label{targetzzztuplezzzorzzzexprb}
\begin{tabular}{lcl}
{\bf \verb+<+target\_tuple\_or\_expr\verb+>+} & ::=  & {\bf \verb+<+target\_tuple~\ref{targetzzztupleb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+expr~\ref{exprb}\verb+>+}  \\
\end{tabular}

\rulesection{target\_tuple}
\label{targetzzztupleb}
\begin{tabular}{lcl}
{\bf \verb+<+target\_tuple\verb+>+} & ::=  & {\bf \verb+<+exprlist~\ref{exprlistb}\verb+>+}  \\
\end{tabular}

\rulesection{testlist\_safe}
\label{testlistzzzsafeb}
\begin{tabular}{lcl}
{\bf \verb+<+testlist\_safe\verb+>+} & ::=  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| {\bf \verb+<+testlist~\ref{testlistb}\verb+>+}  \\
\end{tabular} \\

Used in list comprehensions (\ref{listzzzforb}).  A safe \verb|testlist| cannot end with a comma.

\rulesection{dictmaker}
\label{dictmakerb}
\begin{tabular}{lcl}
{\bf \verb+<+dictmaker\verb+>+} & ::=  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| \\
 & \verb+|+  & {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|:| {\bf \verb+<+test~\ref{testb}\verb+>+}  \verb|,| {\bf \verb+<+dictmaker~\ref{dictmakerb}\verb+>+}  \\
\end{tabular}

\rulesection{ident}
\label{identb}
\begin{tabular}{lcl}
{\bf \verb+<+ident\verb+>+} & ::=  & NAME \\
\end{tabular} \\

The NAME token is a valid Python identifier.  A valid Python identifier is an alphanumeric sequence of characters starting with a letter.  The underscore character (\_) counts as a letter.  The language is case-sensitive.
