
# Builds MzScheme and MrEd

all: mz @MAKE_MRED@

3m: mz3m @MAKE_MRED3M@

install: @MAKE_COPYTREE@ mzinstall @MAKE_MREDINSTALL@ lib-finish @MAKE_FINISH@

clean:
	cd mzscheme; $(MAKE) clean
	if [ -d mred ] ; then cd mred; $(MAKE) clean; fi

mz:
	cd mzscheme; $(MAKE)

mz3m:
	cd mzscheme; $(MAKE) 3m

mr:
	cd mred; $(MAKE)

mr3m:
	cd mred; $(MAKE) 3m

mzinstall:
	cd mzscheme; $(MAKE) install

mrinstall:
	cd mred; $(MAKE) install

lib-finish:
	@LIBFINISH@ @prefix@/lib

srcdir = @srcdir@
prefix = @prefix@

copy-finish:
	if [ @MZINSTALLTARGET@ = "normal-install" ] ; then cd $(prefix); ./install ; fi

inplace-finish:
	if [ ! -d $(srcdir)/CVS ] ; then cd $(prefix); ./install ; fi
	if [ -d $(srcdir)/CVS ] ; then echo; echo ">> run plt/install or setup-plt -c to finish <<" ; echo; fi

copytree:
	if [ ! -d $(prefix) ] ; then mkdir $(prefix) ; fi
	cp -p -r $(srcdir)/../collects $(prefix)/.
	if [ @MZINSTALLTARGET@ = "normal-install" ] ; then cp -p -r $(srcdir)/../bin $(prefix)/. ; fi
	cp -p -r $(srcdir)/../include $(prefix)/.
	cp -p -r $(srcdir)/../notes $(prefix)/.
	cp -p -r $(srcdir)/../man $(prefix)/.
	if [ -d $(srcdir)/../teachpack ] ; then  cp -r $(srcdir)/../teachpack $(prefix)/teachpack ; fi
	if [ @MZINSTALLTARGET@ = "normal-install" ] ; then cp -p $(srcdir)/../install $(prefix)/install ; fi
