\documentclass{article}
\usepackage{slatex}
\makeindex
\begin{document}
\setkeyword{get-az get-alt get-z-max get-z-min plot-surface plot-error-bars plot-shades plot-contours plot-line plot-points plot-vectors plot-vector set-labels make-vec gradient derivative 3d-renderer 2d-renderer r-lambda 3d-view% 2d-view% view-snip% fit-lambda fit-result-function fit-result-final-params fit mix* mix plot3d plot error-bars line shade surface points field contour }

\tableofcontents
\pagebreak

\section{Introduction}

PLTplot provides a basic interface for producing common types
of plots such as line and vector field plots
as well as an advanced interface for producing customized plot types.
Additionally, plots and plot-items are first-class values and can be generated
in and passed to other programs.


\pagebreak

\section{Overview}

\subsection{Making basic plots}


After loading the correct module using 
\scheme{(require (lib "plot.ss" "plot"))} try \scheme{(plot (line (lambda (x) x)))}


Any other function with the contract \scheme{number -> number} can be plotted using the same form. To plot multiple items, use the functions \scheme{mix} and \scheme{mix*} to combine the items to be plotted 
\begin{schemedisplay}

(plot 
 (mix 
  (line (lambda (x) (sin x))) 
  (line (lambda (x) (cos x))))) 
\end{schemedisplay}



The display area and appearance of the plot can be changed by adding 
      parenthesized  argument/value pairs after the first argument
\begin{schemedisplay}

(plot 
 (line (lambda (x) (sin x))) 
 (x-min -1) (x-max 1) (title "Sin(x)")) 
      
\end{schemedisplay}


The appearance of each individual plot item can be altered by adding parameter-value pairs after the
data.
\begin{schemedisplay}
(plot 
 (line 
  (lambda (x) x) 
  (color 'green) (width 3)))
\end{schemedisplay}

Besides plotting lines from functions in 2d, the plotter
      can also render a variety of other datums
      in several ways:
\begin{itemize}
\item 
  Discreet data, such as
  \begin{schemedisplay}
    
(define data 
 (list 
  (vector 1 1 2) 
  (vector 2 2 2)))
\end{schemedisplay}
can be interpreted in several ways\begin{itemize}
\item As points: \scheme{(plot (points data))}
\end{itemize}
\begin{itemize}
\item As Error Data: \scheme{(plot (error-bars data))}
\end{itemize}
\begin{itemize}
%\item as a spline? maybe later..
\end{itemize}


\item 
  A function of two variables, such as
\begin{schemedisplay}
(define 3dfun (lambda (x y) (* (sin x) (sin y))))
\end{schemedisplay}
can be plotted on a 2d graph
\begin{itemize}
\item Using contours to represent height (z)
 \begin{schemedisplay}
(plot (contour 3dfun))
\end{schemedisplay}

\item Using color shading
\begin{schemedisplay}
(plot (shade 3dfun))
\end{schemedisplay}

\item Using a gradient field
\begin{schemedisplay}
(plot (field (gradient 3dfun)))
\end{schemedisplay}

\end{itemize}
or in a 3d box\begin{itemize}
\item Displaying only the top of the surface
\begin{schemedisplay}
(plot3d (surface 3dfun))
\end{schemedisplay}

%\item Display the bottom of the surface...
%\item Displaying the surface using magnitude - valued coloration...
\end{itemize}



\end{itemize}

\index{curve fitting}
\index{fitting}
\label{Curve Fitting}
\subsection{Curve Fitting}



The scheme-plot library uses a Non-Linear Least Squares fit algorithm 
       to fit parametrized functions to given data.


To fit a particular function to a curve:
\begin{enumerate}
\item Set up the independent and dependent variable data. The first item in each vector is the 
independant var, the second is the result. The last item must is the weight of the error - we can leave 
it as 1 since all the items weigh the same.
\begin{schemedisplay}

(define data '(#(0 3 1)
               #(1 5 1)
               #(2 7 1)
               #(3 9 1)
               #(4 11 1)))

\end{schemedisplay}

\item Set up the function to be fitted using fit. This particular function
         looks like a line. The independant variables must come before the parameters.
\begin{schemedisplay}

(define fit-fun 
 (lambda (x m b) (+ b (* m x))))
\end{schemedisplay}

\item If possible, come up with some guesses for the values of the parameters.
        The guesses can be left as one, but each parameter must be named.


\item Do the fit - the details of the function are described in \urlh{#Fitting}{Curve Fitting} section
\begin{schemedisplay}

(define fit-result 
  (fit 
   fit-fun 
   ((m 1) (b 1)) 
   data)
\end{schemedisplay}

\item View the resulting parameters
\begin{schemedisplay}

(fit-result-final-params fit-result) ; will produce ((m 2) (b 3))         
         
\end{schemedisplay}

\item For some visual feedback of the fit result, plot the function 
         with the new parameters. For convenience, the structure that is returned
         by the fit command has already created the function.
\begin{schemedisplay}

(plot (mix 
        (points data)
        (line (fit-result-function fit-result)))
      (y-max 15))
\end{schemedisplay}

\end{enumerate}

A more realistic example can be found in {\tt demos/fit-demo-2.ss}

\subsection{Creating Custom Plots}


Defining custom plots is simple : a Plot-item (that is passed to plot or mix) is just a function
       that acts on a \urlh{#2d-view} {view }. Both the 2d and 3d view snip have several drawing
functions defined that
the plot-item can call in any order. The full details of the view interface can be found in the
\urlh{plot-extend.ss} {plot-extend.ss} section. 


For example, if we wanted to create a constructor that creates Plot-items that 
       draw dashed-lines given a number-number function we could do the following:
\begin{schemedisplay}
; Load the required modules
(require (lib "class.ss")
         (lib "plot-extend.ss" "plot"))


; Set up the constructor
(define-plot-type dashed-line
  fun 2dview (x-min x-max) ((samples 100) (segments 20) (color 'red) (width 1))
  (let* ((dash-size (/ (- x-max x-min) segments))
         (x-lists (build-list 
                   (/ segments 2) 
                   (lambda (index)                                    
                     (x-values 
                      (/ samples segments) 
                      (+ x-min (* 2 index dash-size))
                      (+ x-min (* (add1 ( * 2 index)) dash-size)))))))
    (send* 2dview 
           (set-line-color color)
           (set-line-width width))
    (for-each 
     (lambda (dash)
       (send 2dview plot-line 
              (map (lambda (x) (vector x (fun x))) dash))) 
     x-lists))))

; Plot a test case
(plot (dashed-line (lambda (x) x) '((color red))))
\end{schemedisplay}

\pagebreak

\section{plot.ss}

The plot.ss module provides the ability to make basic plots, fit curves to data, and some useful miscellaneous functions.

\subsection{Plotting}


The \scheme{plot} and \scheme{plot3d} forms generate plots that can be viewed in the DrScheme interactions window. The functions and data definitions for this  module are as follows:



\begin{schemedisplay}

       
Forms:
       
 (plot 2d-plot-item 2d-plot-option*) -> VIEW
 (plot3d 3d-plot-item 3d-plot-option*) -> VIEW
     
2d-plot-option is one of:
 (x-min number)
 (x-max number)
 (y-min number)
 (y-max number)
 (x-label string)
 (y-label string)
 (title string)
     
3d-plot-option is one of:
 2d-plot-option
 (z-label)
 (z-min number)
 (z-max number)
 (alt number)    ; altitude angle, in degrees
 (az number)     ; azimuthal angle, in degrees
     
\end{schemedisplay}



The 2d and 3d plot-options modify the view in which the graph is drawn. The 3d-plot-options alt and az set the viewing altitude (in degrees) and azimuth (also in degrees) respectively. The rest of the options should be self-explanatory.



\begin{schemedisplay}
Data Definitions:
     
2d-plot-item is one of:

 (points (list-of (vector number number)) point-options*)
 (line [(number -> number) | (number -> number number)] line-options*)
 (error-bars (list-of (vector number number number)) error-bar-options*)
 (field r2->r2 field-options*)
 (contour (number number -> number) contour-options*)
 (shade (number number -> number) shade-options*)
 (mix 2d-plot-item 2d-plot-item+)
 (custom (2d-view% -> void))
     
3d-plot-item is one of:
 (surface (number number -> number) surface-options*)
 (mix 3d-plot-item 3d-plot-item+)
 (custom (3d-view% -> void))

note: all of the options appear as (name value) parenthesized expressions
the -> means `default'

point-options are:
 sym : symbol -> 'square
 color : symbol -> 'black

line-options are:
 samples : number -> 150
 width : number -> 1
 color : symbol -> 'red
 mode : symbol -> 'standard
 mapping : symbol -> 'cartesian
 t-min : number -> -5
 t-max : number -> 5
 
error-bar-options are:
 color : symbol -> 'red

field-options are:
 color : symbol -> 'red
 width : number -> 1
 style : symbol -> 'scaled

contour-options are:
 samples : number -> 50
 color : symbol -> black
 width : number -> 1
 levels : number U (list-of number) -> 10

shade-options are:
 samples : number -> 50
 levels : number -> 10

surface-options are:
 samples : number -> 50
 color : symbol -> black
 width : number -> 1
\end{schemedisplay}



The 2d and 3d plot-items can be created in several ways. The first is by using the built-in constructors with your own data. 


\scheme{points} will draw points on a graph given a list. of vectors specifying their location. Sym changes the appearence of the points (either 'circle or 'square).


\scheme{line} will draw a line specified in either functional, ie. y=f(x), or  parametric mode, x,y = f(t) . If the function is parametric, the line-option \scheme{mode} must be set to \scheme{parametric}. \scheme{t-min} and \scheme{t-max} set the parameter when in parametric mode. \scheme{mapping} can be set to \scheme{'radial}.


\scheme{error-bars} will draw error bars given a list of vectors. The vector specifies the  center of the error bar (x,y) as the first two elements, and it's magnitude as the third


\scheme{field} will draw a vector field from a vector valued function. Styles are either \scheme{real}, \scheme{scaled}, or \scheme{normalized}. 


Both \scheme{shade} and \scheme{contour} will render 3d functions on a 2d graph using colored shades and contours (respectively) to represent the value of the function at that position. \scheme{contour} will let you choose the levels explicitly if desired, by setting the \scheme{levels} option to a list of contour levels to be plotted.

\scheme{surface} plots a 3d surface in a 3d box, showing only the \emp{top} of the surface

\subsection{Fitting}
\label{Fitting}


PLTPlot uses the standard Non-Linear Least Squares fit algorithm for curve fitting. The code that implements the algorithm is public domain, and is used by the gnuplot package.



\begin{schemedisplay}

Data:
       
a fit-result is 
  (fit (number*-> number) parameter-guess-list  data)       
  
  
parameter-guess-list is a set of name-value pairs enclosed in (..)
  
data is
  (list-of (vector number number number))
| (list-of (vector number number number number))
  
Functions:
  
  fit-result-function : fit-result -> procedure
  fit-result-final-params : fit-result -> guess-list
      
       
\end{schemedisplay}



The \scheme{fit} form attempts to fit a a \scheme{fittable-function} to the data that is given.The \scheme{guess-list}should be set of parameters and values. The more accurate  your initial guesses are, the more likely the fit is to succeed. If there are no good values for the guesses, leave them as 1


\scheme{fit-result-final-params} returns an assosiative list of the parameters specified  in fit
 and their values. Note that the values may not be correct if the fit failed to converge. 
For a visual test use \scheme{fit-result-function} to get the function with the parameters 
in place and plot it along with the original data.

\subsection{Misc Functions}


The plot library comes with a few useful miscilanious functions


\begin{schemedisplay}

derivative      : (number -> number) [h .000001] -> (number -> number)   
gradient : (number number -> number) [h .000001] -> (vector -> vector)
make-vec : (number number -> number) (number number -> number) -> (vector -> vector) 
\end{schemedisplay}

\scheme{derivative} creates a function that evaluates the numeric derivative of the given  single-variable function using the definition. \scheme{h} is the divisor used in the calculation.


\scheme{gradient} creates a vector-valued function that is the gradient of the given function.\scheme{h} represents the numeric divisor, as with the derivative function


\scheme{make-vec} creates one vector valued function from two parts.

\pagebreak


\index{plot-extend.ss}
\label{plot-extend.ss}
\section{plot-extend.ss}



plot-extend.ss allows you to create your own constructors, further customize the appearance of the plot windows,
     and in general extend the package.


\index{2d-view\%}
\label{2d-view}
\subsection{\scheme{2d-view%}}


Provides an interface to drawing 2dplots. Some methods call low-level functions while others are emulated in scheme.

\begin{itemize}
\item 
\scheme{set-labels : string string string -> void}


Sets x, y and title labels


\item 
\scheme{plot-vector : vector vector -> void}


Plots a single vector. First argument is the head, second is the tail.


\item 
\scheme{plot-vectors : (listof (list vector vector)) -> void}


Plots a list of vectors. Each vector is a list of two scheme \scheme{vector}s.


\item 
\scheme{plot-points : (listof vector) number ->void}


Plots points using a specified charater. ** provide character map **


\item 
\scheme{plot-line : (listof (vector number number)) -> void}


Plots a line given a set of points. Each point is represented by a \scheme{vector}.


\item 
\scheme{plot-contours : (listof (lisftof number)) (listof number) (listof number) (listof number) ->void}


plots a grid representing a 3d function using contours to distinguish levels. 
Args are grid, xvalues yvalues and levels to plot. 


\item 
\scheme{plot-shades : (listof (lisftof number)) (listof number) (listof number) (listof number) ->void }


plots a grid representing a 3d function using shades to represent height (z)


\end{itemize}
\index{3d-view\%}
\label{3d-view}
\subsection{\scheme{3d-view%}}




Provides an interface to drawing 3d plots. 

\begin{itemize}
\item 
\scheme{plot-surface : (listof (lisftof number)) (listof number) (listof number) ->void }

plots a grid representing a 3d function in a 3D box, showing only the top of the surface

\item 
\scheme{plot-line : (listof number) (listof number) (listof number) -> void}

Plots a line in 3d space. The arguments are lists of x,y and z coordinates respectively.


\item 
\scheme{get-z-min : -> number}


Returns the minimum plottable Z coordinate. 


\item 
\scheme{get-z-max : -> number}


Returns the maximum plottable Z coordinate


\item 
\scheme{get-alt : -> number}


Returns the altitude (in degrees) from which the 3d box is viewed


\item 
\scheme{get-az : -> number}


Returns the azumuthal angle


\end{itemize}

\label{define-plot-type}
\index{define-plot-type}
\subsection{\scheme{define-plot-type}}


Macro used to create new constructors. It is easiest to explain with  an example, 
so here is an implementation of a simple line constructor :
\begin{schemedisplay}

(define-plot-type line 
   func 2dplotview (x-min x-max) ((samples 150) (color 'red) (width 1))
   (send* 2dplotview 
    (set-line-color color) (set-line-width width)
    (plot-line (map 
                  (lambda (x) (vector x (func x))) 
                  (x-values samples x-min x-max)))))
\end{schemedisplay}
\begin{itemize}
\item The first keyword after then name of the new plot type, is used to refer to 
         the data that will be rendered. In this case, we will are calling our data \scheme{func}.
         For example, in the execution of \scheme{(plot (line (lambda (x) x))) func} would refer 
         to the indentify function
\item \scheme{2dplotview} refers to the name of the view object that the 
         Plot-item will be applied to by \scheme{plot}
\item The \scheme{x-min} and \scheme{x-max} are fields in the 
  \scheme{2d-view%} 
    object. They will be bound to the values of 
  those fields before the execution of the body
  , assuming the object has the methods \scheme{get-x-min} 
  and \scheme{get-x-max}. This entire expression can be 
  omitted if none of the fields are necessary 
  (such as for plotting discrete data points)
\item The last set of parenthesized expressions sets 
  keywords based arguments and their default
  values for the constructor. To over-ride values the user needs to 
  provide an associative list with the desired values. 
  Ex: \scheme{(line (lambda (x) x) '((color blue)))}
\end{itemize}

\pagebreak
\section{Index}

\inputindex

\end{document}
