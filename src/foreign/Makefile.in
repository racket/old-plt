# Makefile for all foreign-related libraires

srcdir = @srcdir@
CC = @CC@
CFLAGS = @CFLAGS@ @COMPFLAGS@ @PREFLAGS@ @PROFFLAGS@ @OPTIONS@ @MZOPTIONS@ \
         -I$(srcdir)/../mzscheme/include -Igcc/libffi/include
AR = @AR@
ARFLAGS = @ARFLAGS@

LIBFFI_A = gcc/libffi/.libs/libffi.a

# compile sub-libraries & foreign.c, then extract all .a files here so we have
# a single directory with all object files.
all: $(LIBFFI_A) foreign.o
	$(AR) x $(LIBFFI_A)

$(LIBFFI_A):
	cd gcc/libffi; $(MAKE) libffi.la

foreign.o: $(srcdir)/foreign.c
	$(CC) $(CFLAGS) -c $(srcdir)/foreign.c -o foreign.o
